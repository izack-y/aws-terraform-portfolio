# 🚀 AWS Webアプリケーション基盤構築プロジェクト (Terraform/IaC)

## 💡 プロジェクト概要と目標

概要：私は9月末にAWS認定クラウドプラクティショナーを取得し、AWSの基礎概念を理解しました。また、AIからの助言も踏まえ、実践的なネットワーク構築経験が最も有効なアピールになると判断しました。この背景に基づき、座学の知識から一歩進み、自身の力でAWS上に管理可能なネットワーク環境を構築しようと思いました。
   　　
* **目標**: クラウド上のネットワーク設計、セキュリティ設計、リソースのデプロイ、および構成管理の習熟。
* **環境**: AWS (ap-northeast-1 / 東京リージョン)

---

## ⚙️ 技術スタックと構成図

### 技術スタック
| カテゴリ | 採用技術 |
| :--- | :--- |
| **クラウド** | AWS (VPC, EC2, RDS, Security Group, IGW) |
| **IaC** | Terraform (HCL) |
| **Web/DB** | Apache HTTP Server, PHP, MySQL (RDS) |
| **AI** | Gemini,chatGPT |


### インフラ構成図
![AWS Webアプリ構成図: Web層とDB層の分離](images/AWSdrawio.png)


* **VPC設計**: セキュリティレベルに応じて **パブリックサブネット** と **プライベートサブネット** に分割。
* **Web/DB配置**: EC2 Webサーバーをパブリックに、機密情報を含む RDS データベースをプライベートに配置し、データ層をインターネットから隔離。
* **セキュリティ**: セキュリティグループ（SG）で通信を厳密に制御。EC2は**ssh**（ポート 20）と**HTTP**（ポート 80）のみ許可。RDSは**EC2からのアクセス**（ポート 3306）のみ許可。

---

## 🌟 工夫点と課題解決 

### 1. IaCにおけるインフラの安定性確保

Terraformでコードの変数定義を変更した際、Webサーバー (EC2) が**「再作成（破壊的変更）」**されるリスクが発生しました。

* **対応**: `aws_instance` リソースに対し、**`lifecycle` ブロック**の **`ignore_changes`** を設定し、EC2の再作成を回避。デプロイの安定性とインフラの継続性を担保しました。

### 2. コードの保守性とセキュリティ向上

* **コード整理**: 変更可能性がある値(regionなど)と機密情報(RDSのパスワードなど)を変数定義 し、それを **`variables.tf`** にまとめ分離した。それによって、main.tf(リソース定義)の可読性と機密性の向上。
* **機密情報の管理**: **`.gitignore`** を用いて機密情報ファイルがGitHubにアップロードされない仕組みを徹底した。

### 3. アプリケーション公開時のトラブルシューティング

ファイルアップロード後のWebサイト表示において、以下の課題を解決しました。

* **課題**: `Permission denied` エラーが発生し、ファイルが転送できない。
    * **解決**: SSHでログインし、`sudo chown` と `sudo chmod` コマンドで Webサーバーの公開ディレクトリの**権限を修正**し、アップロードを可能にした。
* **課題**: 「It works!」が表示され、コンテンツが見えなかった。
    * **解決**: ファイル構造を確認し、Apacheのデフォルト設定に合わせるため、メインファイルを **`index.html` にリネーム**することで解決した。

### 4　接続確認
作成したWEBサーバーの接続確認方法として、WEBサーバーのパブリックIPアドレスを取得し、HTTP通信で確認。
作成したRDSの接続確認方法として、index.phpファイルを作成。そこにRDSサーバーの接続条件とトライキャッチ構文を作成して再度WEBサーバーのパブリックIPアドレスで通信をした。

